{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\katzi\\\\OneDrive\\\\\\u05DE\\u05E1\\u05DE\\u05DB\\u05D9\\u05DD\\\\New folder (2)\\\\SocialNetwork\\\\EffiSocial\\\\client\\\\src\\\\components\\\\AddFriend.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useNavigate } from 'react-router-dom';\nimport { Box, TextField, Button, List, ListItem, ListItemAvatar, ListItemText, Avatar, IconButton, Paper, Typography, CircularProgress, Alert } from '@mui/material';\nimport { Person as PersonIcon, PersonAdd as PersonAddIcon, Cancel as CancelIcon, Check as CheckIcon } from '@mui/icons-material';\nimport { users } from '../services/api';\nimport { useAuth } from '../context/AuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AddFriend = () => {\n  _s();\n  var _searchResults$data;\n  const {\n    user\n  } = useAuth();\n  const navigate = useNavigate();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  console.log('=== AddFriend Component ===');\n  console.log('Auth user:', user);\n  const searchMutation = useMutation({\n    mutationFn: async query => {\n      console.log('=== Search Mutation Function ===');\n      console.log('Search query:', query);\n      console.log('Current auth user:', user);\n      const response = await users.search(query);\n      console.log('Search mutation response:', response);\n      return response;\n    },\n    onSuccess: data => {\n      console.log('=== Search Mutation Success ===');\n      console.log('Search results data:', data);\n      setSearchResults(data);\n      setError(null);\n    },\n    onError: error => {\n      var _error$response, _error$response2, _error$response3, _error$response3$data;\n      console.error('=== Search Mutation Error ===');\n      console.error('Error details:', {\n        message: error.message,\n        response: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data,\n        status: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status\n      });\n      setError(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || 'Error searching users');\n    }\n  });\n\n  // Debounced search effect\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (searchQuery.trim().length >= 3) {\n        console.log('=== Debounced Search ===');\n        console.log('Search query:', searchQuery);\n        console.log('Current auth user:', user);\n        setLoading(true);\n        searchMutation.mutate(searchQuery, {\n          onSettled: () => {\n            console.log('=== Search Settled ===');\n            setLoading(false);\n          }\n        });\n      }\n    }, 500); // 500ms debounce\n\n    return () => clearTimeout(timer);\n  }, [searchQuery]);\n  const sendRequestMutation = useMutation({\n    mutationFn: async userId => {\n      console.log('=== Send Request Mutation Function ===');\n      console.log('Sending friend request to:', userId);\n      console.log('Current auth user:', user);\n      const response = await users.sendFriendRequest(userId);\n      console.log('Send request mutation response:', response);\n      return response;\n    },\n    onSuccess: data => {\n      console.log('=== Send Request Mutation Success ===');\n      console.log('Friend request sent successfully:', data);\n      setError(null);\n      // Optionally refresh search results\n      if (searchQuery) {\n        searchMutation.mutate(searchQuery);\n      }\n    },\n    onError: error => {\n      var _error$response4, _error$response5, _error$response6, _error$response6$data;\n      console.error('=== Send Request Mutation Error ===');\n      console.error('Error details:', {\n        message: error.message,\n        response: (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data,\n        status: (_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.status\n      });\n      setError(((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.error) || 'Error sending friend request');\n    }\n  });\n  const cancelRequestMutation = useMutation({\n    mutationFn: async userId => {\n      return await users.cancelFriendRequest(userId);\n    },\n    onSuccess: () => {\n      if (searchQuery) {\n        searchMutation.mutate(searchQuery);\n      }\n    },\n    onError: error => {\n      var _error$response7, _error$response7$data;\n      setError(((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.error) || 'Error cancelling friend request');\n    }\n  });\n  const handleSendOrCancelRequest = async (userId, hasPendingRequest) => {\n    if (hasPendingRequest) {\n      try {\n        await cancelRequestMutation.mutateAsync(userId);\n      } catch (error) {\n        console.error('Cancel request error:', error);\n      }\n    } else {\n      try {\n        await sendRequestMutation.mutateAsync(userId);\n      } catch (error) {\n        console.error('Send request error:', error);\n      }\n    }\n  };\n  const handleProfileClick = userId => {\n    console.log('Navigating to profile:', userId);\n    navigate(`/profile/${userId}`);\n  };\n\n  // Fetch current user's friend requests for incoming check\n  const {\n    data: myFriendRequestsData\n  } = useQuery({\n    queryKey: ['myFriendRequests', user === null || user === void 0 ? void 0 : user._id],\n    queryFn: () => users.getFriendRequests(),\n    enabled: !!(user !== null && user !== void 0 && user._id)\n  });\n  const myFriendRequests = Array.isArray(myFriendRequestsData === null || myFriendRequestsData === void 0 ? void 0 : myFriendRequestsData.data) ? myFriendRequestsData.data : [];\n  console.log('myFriendRequestsData:', myFriendRequestsData);\n  console.log('myFriendRequests:', myFriendRequests);\n\n  // Filter out current user from search results\n  const usersList = (searchResults === null || searchResults === void 0 ? void 0 : (_searchResults$data = searchResults.data) === null || _searchResults$data === void 0 ? void 0 : _searchResults$data.filter(searchUser => {\n    const isNotCurrentUser = searchUser._id !== ((user === null || user === void 0 ? void 0 : user.id) || (user === null || user === void 0 ? void 0 : user._id));\n    console.log('Filtering user:', {\n      searchUserId: searchUser._id,\n      currentUserId: (user === null || user === void 0 ? void 0 : user.id) || (user === null || user === void 0 ? void 0 : user._id),\n      isNotCurrentUser\n    });\n    return isNotCurrentUser;\n  })) || [];\n  const getFriendButtonState = searchUser => {\n    var _searchUser$friends, _searchUser$friendReq;\n    const isFriend = (_searchUser$friends = searchUser.friends) === null || _searchUser$friends === void 0 ? void 0 : _searchUser$friends.includes(user._id);\n    // Outgoing: did I send a request to them?\n    const hasPendingRequest = (_searchUser$friendReq = searchUser.friendRequests) === null || _searchUser$friendReq === void 0 ? void 0 : _searchUser$friendReq.some(request => request.from === user._id && request.status === 'pending');\n    // Incoming: did they send a request to me?\n    const hasReceivedRequest = myFriendRequests.some(request => request.from === searchUser._id && request.status === 'pending');\n    if (isFriend) {\n      return {\n        type: 'icon',\n        disabled: true,\n        icon: /*#__PURE__*/_jsxDEV(CheckIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 15\n        }, this),\n        color: 'success',\n        sx: {\n          width: '40px',\n          height: '40px',\n          borderRadius: '50%',\n          border: '1px solid',\n          borderColor: 'success.main',\n          color: 'success.main',\n          '&:hover': {\n            backgroundColor: 'success.light',\n            borderColor: 'success.main'\n          },\n          padding: '0'\n        }\n      };\n    } else if (hasPendingRequest) {\n      return {\n        type: 'button',\n        text: 'Cancel Request',\n        disabled: false,\n        icon: /*#__PURE__*/_jsxDEV(CancelIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 15\n        }, this),\n        color: 'error',\n        variant: 'outlined',\n        sx: {\n          minWidth: '120px',\n          borderRadius: '20px',\n          textTransform: 'none',\n          fontWeight: 500,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '4px',\n          px: '12px'\n        }\n      };\n    } else if (hasReceivedRequest) {\n      return {\n        type: 'button',\n        text: 'Respond',\n        disabled: false,\n        icon: /*#__PURE__*/_jsxDEV(PersonAddIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 15\n        }, this),\n        color: 'primary',\n        variant: 'outlined',\n        sx: {\n          minWidth: '100px',\n          borderRadius: '20px',\n          textTransform: 'none',\n          fontWeight: 500,\n          borderColor: 'primary.main',\n          color: 'primary.main',\n          '&:hover': {\n            backgroundColor: 'primary.light',\n            borderColor: 'primary.main'\n          },\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '4px',\n          px: '12px'\n        }\n      };\n    } else {\n      return {\n        type: 'button',\n        text: 'Add Friend',\n        disabled: false,\n        icon: /*#__PURE__*/_jsxDEV(PersonAddIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 15\n        }, this),\n        color: 'primary',\n        variant: 'contained',\n        sx: {\n          minWidth: '120px',\n          borderRadius: '20px',\n          textTransform: 'none',\n          fontWeight: 500,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '4px',\n          px: '12px'\n        }\n      };\n    }\n  };\n  console.log('=== Search Results Processing ===');\n  console.log('Raw search results:', searchResults);\n  console.log('Current auth user:', user);\n  console.log('Filtered users list:', usersList);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      p: 2\n    },\n    children: [/*#__PURE__*/_jsxDEV(Paper, {\n      elevation: 0,\n      sx: {\n        p: 2,\n        mb: 2,\n        backgroundColor: 'transparent'\n      },\n      children: /*#__PURE__*/_jsxDEV(TextField, {\n        fullWidth: true,\n        variant: \"outlined\",\n        placeholder: \"Search users...\",\n        value: searchQuery,\n        onChange: e => setSearchQuery(e.target.value),\n        InputProps: {\n          startAdornment: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              color: 'text.secondary',\n              mr: 1\n            },\n            children: /*#__PURE__*/_jsxDEV(PersonIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this),\n          sx: {\n            borderRadius: '20px',\n            backgroundColor: 'background.paper',\n            '& .MuiOutlinedInput-notchedOutline': {\n              borderColor: 'divider'\n            },\n            '&:hover .MuiOutlinedInput-notchedOutline': {\n              borderColor: 'primary.main'\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      sx: {\n        mb: 2\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 9\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: 'center',\n        p: 2\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 9\n    }, this) : searchQuery.length >= 3 ? /*#__PURE__*/_jsxDEV(List, {\n      sx: {\n        bgcolor: 'background.paper',\n        borderRadius: '12px',\n        boxShadow: '0 2px 4px rgba(0,0,0,0.05)'\n      },\n      children: usersList.map(searchUser => {\n        var _searchUser$friendReq2;\n        const buttonState = getFriendButtonState(searchUser);\n        const hasPendingRequest = (_searchUser$friendReq2 = searchUser.friendRequests) === null || _searchUser$friendReq2 === void 0 ? void 0 : _searchUser$friendReq2.some(request => request.from === user._id && request.status === 'pending');\n        return /*#__PURE__*/_jsxDEV(ListItem, {\n          sx: {\n            borderBottom: '1px solid',\n            borderColor: 'divider',\n            '&:last-child': {\n              borderBottom: 'none'\n            },\n            py: 1.5,\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          },\n          secondaryAction: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: buttonState.type === 'icon' ? /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => handleSendOrCancelRequest(searchUser._id, hasPendingRequest),\n              disabled: buttonState.disabled || sendRequestMutation.isLoading,\n              color: buttonState.color,\n              sx: buttonState.sx,\n              children: buttonState.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(Button, {\n              variant: buttonState.variant,\n              size: \"small\",\n              startIcon: buttonState.icon,\n              onClick: () => handleSendOrCancelRequest(searchUser._id, hasPendingRequest),\n              disabled: buttonState.disabled || sendRequestMutation.isLoading,\n              color: buttonState.color,\n              sx: buttonState.sx,\n              children: buttonState.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 21\n            }, this)\n          }, void 0, false),\n          children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n            children: /*#__PURE__*/_jsxDEV(Avatar, {\n              src: searchUser.profilePicture ? `http://localhost:5000${searchUser.profilePicture}` : undefined,\n              alt: searchUser.username,\n              onClick: () => handleProfileClick(searchUser._id),\n              sx: {\n                cursor: 'pointer',\n                width: 48,\n                height: 48,\n                border: '2px solid',\n                borderColor: 'divider',\n                '&:hover': {\n                  borderColor: 'primary.main'\n                },\n                marginRight: '16px'\n              },\n              children: /*#__PURE__*/_jsxDEV(PersonIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n            primary: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"span\",\n              onClick: () => handleProfileClick(searchUser._id),\n              sx: {\n                cursor: 'pointer',\n                fontWeight: 500,\n                '&:hover': {\n                  color: 'primary.main',\n                  textDecoration: 'underline'\n                },\n                flexGrow: 1,\n                flexShrink: 1,\n                minWidth: 0,\n                whiteSpace: 'nowrap',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                marginRight: '8px'\n              },\n              children: searchUser.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 17\n          }, this)]\n        }, searchUser._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 277,\n    columnNumber: 5\n  }, this);\n};\n_s(AddFriend, \"7GKLoRsnnD82f5GMBo78lJ9Thus=\", false, function () {\n  return [useAuth, useNavigate, useQueryClient, useMutation, useMutation, useMutation, useQuery];\n});\n_c = AddFriend;\nexport default AddFriend;\nvar _c;\n$RefreshReg$(_c, \"AddFriend\");","map":{"version":3,"names":["React","useState","useEffect","useQuery","useMutation","useQueryClient","useNavigate","Box","TextField","Button","List","ListItem","ListItemAvatar","ListItemText","Avatar","IconButton","Paper","Typography","CircularProgress","Alert","Person","PersonIcon","PersonAdd","PersonAddIcon","Cancel","CancelIcon","Check","CheckIcon","users","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","AddFriend","_s","_searchResults$data","user","navigate","queryClient","searchQuery","setSearchQuery","searchResults","setSearchResults","loading","setLoading","error","setError","console","log","searchMutation","mutationFn","query","response","search","onSuccess","data","onError","_error$response","_error$response2","_error$response3","_error$response3$data","message","status","timer","setTimeout","trim","length","mutate","onSettled","clearTimeout","sendRequestMutation","userId","sendFriendRequest","_error$response4","_error$response5","_error$response6","_error$response6$data","cancelRequestMutation","cancelFriendRequest","_error$response7","_error$response7$data","handleSendOrCancelRequest","hasPendingRequest","mutateAsync","handleProfileClick","myFriendRequestsData","queryKey","_id","queryFn","getFriendRequests","enabled","myFriendRequests","Array","isArray","usersList","filter","searchUser","isNotCurrentUser","id","searchUserId","currentUserId","getFriendButtonState","_searchUser$friends","_searchUser$friendReq","isFriend","friends","includes","friendRequests","some","request","from","hasReceivedRequest","type","disabled","icon","fileName","_jsxFileName","lineNumber","columnNumber","color","sx","width","height","borderRadius","border","borderColor","backgroundColor","padding","text","variant","minWidth","textTransform","fontWeight","display","alignItems","justifyContent","gap","px","p","children","elevation","mb","fullWidth","placeholder","value","onChange","e","target","InputProps","startAdornment","mr","severity","bgcolor","boxShadow","map","_searchUser$friendReq2","buttonState","borderBottom","py","secondaryAction","onClick","isLoading","size","startIcon","src","profilePicture","undefined","alt","username","cursor","marginRight","primary","component","textDecoration","flexGrow","flexShrink","whiteSpace","overflow","textOverflow","_c","$RefreshReg$"],"sources":["C:/Users/katzi/OneDrive/מסמכים/New folder (2)/SocialNetwork/EffiSocial/client/src/components/AddFriend.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Box,\r\n  TextField,\r\n  Button,\r\n  List,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n  Avatar,\r\n  IconButton,\r\n  Paper,\r\n  Typography,\r\n  CircularProgress,\r\n  Alert,\r\n} from '@mui/material';\r\nimport {\r\n  Person as PersonIcon,\r\n  PersonAdd as PersonAddIcon,\r\n  Cancel as CancelIcon,\r\n  Check as CheckIcon,\r\n} from '@mui/icons-material';\r\nimport { users } from '../services/api';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nconst AddFriend = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const queryClient = useQueryClient();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  console.log('=== AddFriend Component ===');\r\n  console.log('Auth user:', user);\r\n\r\n  const searchMutation = useMutation({\r\n    mutationFn: async (query) => {\r\n      console.log('=== Search Mutation Function ===');\r\n      console.log('Search query:', query);\r\n      console.log('Current auth user:', user);\r\n      const response = await users.search(query);\r\n      console.log('Search mutation response:', response);\r\n      return response;\r\n    },\r\n    onSuccess: (data) => {\r\n      console.log('=== Search Mutation Success ===');\r\n      console.log('Search results data:', data);\r\n      setSearchResults(data);\r\n      setError(null);\r\n    },\r\n    onError: (error) => {\r\n      console.error('=== Search Mutation Error ===');\r\n      console.error('Error details:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status\r\n      });\r\n      setError(error.response?.data?.error || 'Error searching users');\r\n    }\r\n  });\r\n\r\n  // Debounced search effect\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (searchQuery.trim().length >= 3) {\r\n        console.log('=== Debounced Search ===');\r\n        console.log('Search query:', searchQuery);\r\n        console.log('Current auth user:', user);\r\n        setLoading(true);\r\n        searchMutation.mutate(searchQuery, {\r\n          onSettled: () => {\r\n            console.log('=== Search Settled ===');\r\n            setLoading(false);\r\n          }\r\n        });\r\n      }\r\n    }, 500); // 500ms debounce\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  const sendRequestMutation = useMutation({\r\n    mutationFn: async (userId) => {\r\n      console.log('=== Send Request Mutation Function ===');\r\n      console.log('Sending friend request to:', userId);\r\n      console.log('Current auth user:', user);\r\n      const response = await users.sendFriendRequest(userId);\r\n      console.log('Send request mutation response:', response);\r\n      return response;\r\n    },\r\n    onSuccess: (data) => {\r\n      console.log('=== Send Request Mutation Success ===');\r\n      console.log('Friend request sent successfully:', data);\r\n      setError(null);\r\n      // Optionally refresh search results\r\n      if (searchQuery) {\r\n        searchMutation.mutate(searchQuery);\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      console.error('=== Send Request Mutation Error ===');\r\n      console.error('Error details:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status\r\n      });\r\n      setError(error.response?.data?.error || 'Error sending friend request');\r\n    }\r\n  });\r\n\r\n  const cancelRequestMutation = useMutation({\r\n    mutationFn: async (userId) => {\r\n      return await users.cancelFriendRequest(userId);\r\n    },\r\n    onSuccess: () => {\r\n      if (searchQuery) {\r\n        searchMutation.mutate(searchQuery);\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      setError(error.response?.data?.error || 'Error cancelling friend request');\r\n    }\r\n  });\r\n\r\n  const handleSendOrCancelRequest = async (userId, hasPendingRequest) => {\r\n    if (hasPendingRequest) {\r\n      try {\r\n        await cancelRequestMutation.mutateAsync(userId);\r\n      } catch (error) {\r\n        console.error('Cancel request error:', error);\r\n      }\r\n    } else {\r\n      try {\r\n        await sendRequestMutation.mutateAsync(userId);\r\n      } catch (error) {\r\n        console.error('Send request error:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleProfileClick = (userId) => {\r\n    console.log('Navigating to profile:', userId);\r\n    navigate(`/profile/${userId}`);\r\n  };\r\n\r\n  // Fetch current user's friend requests for incoming check\r\n  const { data: myFriendRequestsData } = useQuery({\r\n    queryKey: ['myFriendRequests', user?._id],\r\n    queryFn: () => users.getFriendRequests(),\r\n    enabled: !!user?._id,\r\n  });\r\n  const myFriendRequests = Array.isArray(myFriendRequestsData?.data) ? myFriendRequestsData.data : [];\r\n  console.log('myFriendRequestsData:', myFriendRequestsData);\r\n  console.log('myFriendRequests:', myFriendRequests);\r\n\r\n  // Filter out current user from search results\r\n  const usersList = searchResults?.data?.filter(searchUser => {\r\n    const isNotCurrentUser = searchUser._id !== (user?.id || user?._id);\r\n    console.log('Filtering user:', {\r\n      searchUserId: searchUser._id,\r\n      currentUserId: user?.id || user?._id,\r\n      isNotCurrentUser\r\n    });\r\n    return isNotCurrentUser;\r\n  }) || [];\r\n\r\n  const getFriendButtonState = (searchUser) => {\r\n    const isFriend = searchUser.friends?.includes(user._id);\r\n    // Outgoing: did I send a request to them?\r\n    const hasPendingRequest = searchUser.friendRequests?.some(\r\n      request => request.from === user._id && request.status === 'pending'\r\n    );\r\n    // Incoming: did they send a request to me?\r\n    const hasReceivedRequest = myFriendRequests.some(\r\n      request => request.from === searchUser._id && request.status === 'pending'\r\n    );\r\n\r\n    if (isFriend) {\r\n      return { \r\n        type: 'icon', \r\n        disabled: true, \r\n        icon: <CheckIcon />,\r\n        color: 'success',\r\n        sx: { \r\n          width: '40px',\r\n          height: '40px',\r\n          borderRadius: '50%',\r\n          border: '1px solid',\r\n          borderColor: 'success.main',\r\n          color: 'success.main',\r\n          '&:hover': {\r\n            backgroundColor: 'success.light',\r\n            borderColor: 'success.main',\r\n          },\r\n          padding: '0',\r\n        }\r\n      };\r\n    } else if (hasPendingRequest) {\r\n      return {\r\n        type: 'button',\r\n        text: 'Cancel Request',\r\n        disabled: false,\r\n        icon: <CancelIcon />,\r\n        color: 'error',\r\n        variant: 'outlined',\r\n        sx: {\r\n          minWidth: '120px',\r\n          borderRadius: '20px',\r\n          textTransform: 'none',\r\n          fontWeight: 500,\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          gap: '4px',\r\n          px: '12px'\r\n        }\r\n      };\r\n    } else if (hasReceivedRequest) {\r\n      return { \r\n        type: 'button', \r\n        text: 'Respond', \r\n        disabled: false, \r\n        icon: <PersonAddIcon />,\r\n        color: 'primary',\r\n        variant: 'outlined',\r\n        sx: { \r\n          minWidth: '100px',\r\n          borderRadius: '20px',\r\n          textTransform: 'none',\r\n          fontWeight: 500,\r\n          borderColor: 'primary.main',\r\n          color: 'primary.main',\r\n          '&:hover': {\r\n            backgroundColor: 'primary.light',\r\n            borderColor: 'primary.main',\r\n          },\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          gap: '4px',\r\n          px: '12px'\r\n        }\r\n      };\r\n    } else {\r\n      return { \r\n        type: 'button', \r\n        text: 'Add Friend', \r\n        disabled: false, \r\n        icon: <PersonAddIcon />,\r\n        color: 'primary',\r\n        variant: 'contained',\r\n        sx: { \r\n          minWidth: '120px',\r\n          borderRadius: '20px',\r\n          textTransform: 'none',\r\n          fontWeight: 500,\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          gap: '4px',\r\n          px: '12px'\r\n        }\r\n      };\r\n    }\r\n  };\r\n\r\n  console.log('=== Search Results Processing ===');\r\n  console.log('Raw search results:', searchResults);\r\n  console.log('Current auth user:', user);\r\n  console.log('Filtered users list:', usersList);\r\n\r\n  return (\r\n    <Box sx={{ p: 2 }}>\r\n      <Paper elevation={0} sx={{ p: 2, mb: 2, backgroundColor: 'transparent' }}>\r\n        <TextField\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          placeholder=\"Search users...\"\r\n          value={searchQuery}\r\n          onChange={(e) => setSearchQuery(e.target.value)}\r\n          InputProps={{\r\n            startAdornment: (\r\n              <Box sx={{ color: 'text.secondary', mr: 1 }}>\r\n                <PersonIcon />\r\n              </Box>\r\n            ),\r\n            sx: {\r\n              borderRadius: '20px',\r\n              backgroundColor: 'background.paper',\r\n              '& .MuiOutlinedInput-notchedOutline': {\r\n                borderColor: 'divider',\r\n              },\r\n              '&:hover .MuiOutlinedInput-notchedOutline': {\r\n                borderColor: 'primary.main',\r\n              },\r\n            },\r\n          }}\r\n        />\r\n      </Paper>\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n\r\n      {loading ? (\r\n        <Box sx={{ display: 'flex', justifyContent: 'center', p: 2 }}>\r\n          <CircularProgress />\r\n        </Box>\r\n      ) : searchQuery.length >= 3 ? (\r\n        <List sx={{ \r\n          bgcolor: 'background.paper',\r\n          borderRadius: '12px',\r\n          boxShadow: '0 2px 4px rgba(0,0,0,0.05)'\r\n        }}>\r\n          {usersList.map((searchUser) => {\r\n            const buttonState = getFriendButtonState(searchUser);\r\n            const hasPendingRequest = searchUser.friendRequests?.some(\r\n              request => request.from === user._id && request.status === 'pending'\r\n            );\r\n            return (\r\n              <ListItem\r\n                key={searchUser._id}\r\n                sx={{\r\n                  borderBottom: '1px solid',\r\n                  borderColor: 'divider',\r\n                  '&:last-child': {\r\n                    borderBottom: 'none'\r\n                  },\r\n                  py: 1.5,\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                }}\r\n                secondaryAction={\r\n                  <>\r\n                  {/* Use IconButton for icon-only buttons */}\r\n                  {buttonState.type === 'icon' ? (\r\n                    <IconButton\r\n                      onClick={() => handleSendOrCancelRequest(searchUser._id, hasPendingRequest)}\r\n                      disabled={buttonState.disabled || sendRequestMutation.isLoading}\r\n                      color={buttonState.color}\r\n                      sx={buttonState.sx}\r\n                    >\r\n                      {buttonState.icon}\r\n                    </IconButton>\r\n                  ) : (\r\n                    <Button\r\n                      variant={buttonState.variant}\r\n                      size=\"small\"\r\n                      startIcon={buttonState.icon}\r\n                      onClick={() => handleSendOrCancelRequest(searchUser._id, hasPendingRequest)}\r\n                      disabled={buttonState.disabled || sendRequestMutation.isLoading}\r\n                      color={buttonState.color}\r\n                      sx={buttonState.sx}\r\n                    >\r\n                      {buttonState.text}\r\n                    </Button>\r\n                  )}\r\n                  </>\r\n                }\r\n              >\r\n                <ListItemAvatar>\r\n                  <Avatar\r\n                    src={searchUser.profilePicture ? `http://localhost:5000${searchUser.profilePicture}` : undefined}\r\n                    alt={searchUser.username}\r\n                    onClick={() => handleProfileClick(searchUser._id)}\r\n                    sx={{ \r\n                      cursor: 'pointer',\r\n                      width: 48,\r\n                      height: 48,\r\n                      border: '2px solid',\r\n                      borderColor: 'divider',\r\n                      '&:hover': {\r\n                        borderColor: 'primary.main'\r\n                      },\r\n                      marginRight: '16px'\r\n                    }}\r\n                  >\r\n                    <PersonIcon />\r\n                  </Avatar>\r\n                </ListItemAvatar>\r\n                <ListItemText\r\n                  primary={\r\n                    <Typography\r\n                      component=\"span\"\r\n                      onClick={() => handleProfileClick(searchUser._id)}\r\n                      sx={{ \r\n                        cursor: 'pointer',\r\n                        fontWeight: 500,\r\n                        '&:hover': { \r\n                          color: 'primary.main',\r\n                          textDecoration: 'underline'\r\n                        },\r\n                        flexGrow: 1,\r\n                        flexShrink: 1,\r\n                        minWidth: 0,\r\n                        whiteSpace: 'nowrap',\r\n                        overflow: 'hidden',\r\n                        textOverflow: 'ellipsis',\r\n                        marginRight: '8px'\r\n                      }}\r\n                    >\r\n                      {searchUser.username}\r\n                    </Typography>\r\n                  }\r\n                />\r\n              </ListItem>\r\n            );\r\n          })}\r\n        </List>\r\n      ) : null}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default AddFriend; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}